<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/user/css/signup.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <title>Document</title>
</head>

<body>
    <% if(error){ %>
        <div class="toast">
            <div class="toast-content">
                <i class="fas fa-solid fa-check check"></i>
                <div class="message">
                    <span class="text text-1">
                        <%= error %>
                    </span>
                    <span class="text text-2"> Please try again</span>
                </div>
            </div>
            <i class="fas fa-solid fa-times close"></i> <!-- Changed to use the correct Font Awesome class -->
            <div class="progress"></div>
        </div>
        <% } %>
            <div class="contain">
                <div class="image"></div>
                <div class="element">
                    <div class="logo"></div>
                    <span id="signup">signup</span>
                    <form action="/signup" method="POST" class="needs-validation">
                        <div class="form-row">
                            <div class="lab"> <label for="firstname">First Name</label></div>
                            <input type="text" name="firstname" id="firstname" class="firstname">
                            <div class="error" id="firstname-error"></div>
                        </div>
                        <div class="form-row">
                            <div class="lab"> <label for="secondname">Second Name</label></div>
                            <input type text" name="secondname" id="secondname" class="secondname">
                            <div class="error" id="secondname-error"></div>
                        </div>
                        <div class="form-row">
                            <div class="lab"><label for="email">Email</label></div>
                            <!-- Changed the 'for' attribute to "email" -->
                            <input type="text" name="email" id="email" class="email">
                            <div class="error" id="email-error"></div>
                        </div>
                        <div class="form-row">
                            <div class="lab"> <label for="phonenumber">Phone Number</label></div>
                            <!-- Changed the 'for' attribute to "phonenumber" -->
                            <input type="text" name="phonenumber" id="phonenumber" class="phonenumber">
                            <div class="error" id="phone-error"></div>
                        </div>
                        <div class="form-row">
                            <div class="lab"> <label for="password">Password</label></div>
                            <input type="password" name="password" id="password" class="password">
                            <div class="error" id="password-error"></div>
                        </div>
                        <div class="form-row">
                            <div class="lab"> <label for="confirmpassword">Confirm Password</label></div>
                            <input type="password" name="confirmpassword" id="confirmpassword" class="confirmpassword">
                            <div class="error" id="confirmPassword-error"></div>
                        </div>
                        <div class="form-row">
                            <input type="submit" name="Login" class="btn btn-success submit" id="Login" value="submit">
                        </div>
                        <div class="form-group" style="text-align: end;">
                            <a href="/login" class="New">Have an account?</a>
                        </div>
                    </form>
                </div>
            </div>
            <script>
                const toast = document.querySelector(".toast");
                const closeIcon = document.querySelector(".close");
                const progress = document.querySelector(".progress");
                let timer1, timer2;

                // Function to show the toast
                function showToast(message) {
                    toast.classList.add("active");
                    progress.classList.add("active");

                    timer1 = setTimeout(() => {
                        toast.classList.remove("active");
                    }, 5000); // 1s = 1000 milliseconds

                    timer2 = setTimeout(() => {
                        progress.classList.remove("active");
                    }, 5300);

                    // Update the message text
                    document.querySelector(".text-2").textContent = message;
                }

                // Function to hide the toast
                function hideToast() {
                    toast.classList.remove("active");

                    setTimeout(() => {
                        progress.classList.remove("active");
                    }, 300);

                    clearTimeout(timer1);
                    clearTimeout(timer2);
                }

                // Example usage
                // Show the toast with a custom message
                showToast("Please try again");

                // Hide the toast after a certain time (e.g., 3 seconds)
                setTimeout(() => {
                    hideToast();
                }, 3000); // Hide after 3 seconds
            </script>
            <script>
                function validateEmail(email) {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+/;
                    return emailRegex.test(email);
                }

                function isEmpty(value) {
                    const trimmedValue = value.trim();
                    return trimmedValue === "";
                }

                function validatePhone(phonenumber) {
                    const phoneRegex = /^\d{10}$/;
                    return phoneRegex.test(phonenumber);
                }

                function validatePassword(password) {
                    // Define the strong password pattern
                    const strongPasswordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#\$%^&*])[A-Za-z\d!@#\$%^&*]{8,}$/;

                    // Test the password against the pattern
                    return strongPasswordPattern.test(password);
                }

                document.querySelector("form").addEventListener("submit", function (event) {
                    const emailInput = document.querySelector("#email");
                    const emailValue = emailInput.value;
                    const emailError = document.querySelector("#email-error");

                    const firstNameInput = document.querySelector("#firstname");
                    const firstNameValue = firstNameInput.value;
                    const firstNameError = document.querySelector("#firstname-error");

                    const lastNameInput = document.querySelector("#secondname");
                    const lastNameValue = lastNameInput.value;
                    const lastNameError = document.querySelector("#secondname-error");

                    const phoneInput = document.querySelector("#phonenumber");
                    const phoneValue = phoneInput.value;
                    const phoneError = document.querySelector("#phone-error");

                    const passwordInput = document.querySelector("#password");
                    const passwordValue = passwordInput.value;
                    const passwordError = document.querySelector("#password-error");

                    const confirmPasswordInput = document.querySelector("#confirmpassword");
                    const confirmPasswordValue = confirmPasswordInput.value;
                    const confirmPasswordError = document.querySelector("#confirmPassword-error");

                    // Clear any previous error messages
                    emailError.textContent = "";
                    firstNameError.textContent = "";
                    lastNameError.textContent = "";
                    phoneError.textContent = "";
                    passwordError.textContent = "";
                    confirmPasswordError.textContent = "";

                    if (isEmpty(emailValue)) {
                        emailError.textContent = "Email can't be empty";
                        event.preventDefault();
                    }
                    if (!validateEmail(emailValue)) {
                        emailError.textContent = "Invalid email format. Please try again.";
                        event.preventDefault();
                    }

                    if (isEmpty(firstNameValue)) {
                        firstNameError.textContent = "First name can't be empty.";
                        event.preventDefault();
                    }

                    if (isEmpty(lastNameValue)) {
                        lastNameError.textContent = "Last name can't be empty.";
                        event.preventDefault();
                    }

                    if (isEmpty(phoneValue)) {
                        phoneError.textContent = "Phone number can't be empty.";
                        event.preventDefault();
                    } else if (!validatePhone(phoneValue)) {
                        phoneError.textContent = "Invalid phone number. Please enter a 10-digit number.";
                        event.preventDefault();
                    }

                    if (!validatePassword(passwordValue)) {
                        passwordError.textContent =
                            "password is too weak"
                        event.preventDefault();
                    }

                    if (passwordValue !== confirmPasswordValue) {
                        confirmPasswordError.textContent = "Passwords do not match.";
                        event.preventDefault();
                    }
                });
            </script>


</body>

</html>